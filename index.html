<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Драконьи услуги в сфере ИИ - ChatGPT от Ориона</title>
	<!-- Firebase App (всегда подключать первым) -->
	<script type="module" src="https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js"></script>
	<script type="module" src="https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore.js"></script>
	<link rel="stylesheet" href="./Stail.css">
</head>
<body>
    <header>
        <h1>Драконьи услуги в сфере ИИ - ChatGPT от Ориона</h1>
        <p>Добро пожаловать в магазин "Драконьи услуги"! Здесь вы можете воспользоваться различными возможностями моделей GPT-4o и связаться со мной, <b>Орионом</b>.</p>
    </header>

    <div class="services-header">
        <h2>Услуги моделей ChatGPT</h2>
    </div>
	
<!-- Контейнер для изображения дракона -->
        <div class="dragon-container">
            <img src="images/dragon.png" alt="Силуэт дракона" class="dragon-image">
        </div>
    </section>

    <section>
        <!-- Категория услуг GPT-4o -->
    <div class="service-category">
        <h3>GPT-4o</h3>
        <ul>
            <li>
                <p>1 вопрос - 5 рублей</p>
                <button onclick="openChat('user1', 'GPT-4o 1')">Задать вопрос</button>
            </li>
            <li>
                <p>5 вопросов - 25 рублей</p>
                <button onclick="openChat('user1', 'GPT-4o 5')">Задать вопросы</button>
            </li>
            <li>
                <p>10 вопросов - 50 рублей</p>
                <button onclick="openChat('user1', 'GPT-4o 10')">Задать вопросы</button>
            </li>
        </ul>
    </div>

    <!-- Категория услуг o1-preview -->
    <div class="service-category">
        <h3>o1-preview</h3>
        <ul>
            <li>
                <p>1 вопрос - 10 рублей</p>
                <button onclick="openChat('user2', 'o1-preview 1')">Задать вопрос</button>
            </li>
            <li>
                <p>5 вопросов - <s>50 рублей</s> 40 рублей (экономия 20%)</p>
                <button onclick="openChat('user2', 'o1-preview 5')">Задать вопросы</button>
            </li>
            <li>
                <p>10 вопросов - <s>100 рублей</s> 75 рублей (экономия 25%)</p>
                <button onclick="openChat('user2', 'o1-preview 10')">Задать вопросы</button>
            </li>
        </ul>
    </div>

    <!-- Категория услуг Редактирование текста с GPT-4o with canvas -->
    <div class="service-category">
        <h3>Редактура с GPT-4o with canvas</h3>
        <ul>
            <li>
                <p>500 символов - 30 рублей</p>
                <button onclick="openChat('user3', 'GPT-4o with canvas Редактирование 500')">Отредактировать текст</button>
            </li>
            <li>
                <p>500-1500 символов - 70 рублей</p>
                <button onclick="openChat('user3', 'GPT-4o with canvas Редактирование 500-1500')">Отредактировать текст</button>
            </li>
            <li>
                <p>1500-3000 символов - 115 рублей</p>
                <button onclick="openChat('user3', 'GPT-4o with canvas Редактирование 1500-3000')">Отредактировать текст</button>
            </li>
        </ul>
    </div>
</section>

    <div id="chat-modal" class="chat-modal">
        <div class="chat-header">
            <span>Чат с Орионом</span>
            <button onclick="closeChat()">&times;</button>
        </div>
        <div class="chat-body" id="chat-body">
            <!-- Сообщения чата будут отображаться здесь -->
        </div>
        <div class="chat-footer">
            <input type="text" id="chat-input" placeholder="Введите сообщение">
            <button onclick="sendMessage()">Отправить</button>
        </div>
    </div>

	<footer id="footer-block">
    <p>Связаться со мной можно через мою группу ВКонтакте: <a href="https://vk.com/fireandscales" target="_blank">ВКонтакте - Fire and Scales</a></p>
    <!--<p style="margin-top: 10px;">Для администраторов: <a href="login.html" style="font-size: 0.8em; text-decoration: none;">Вход в админ-панель</a></p>-->
    <button class="close-button" onclick="closeFooter()">&times;</button>
	</footer>

    <button id="theme-toggle" onclick="toggleTheme()" class="moon">&#x1F311;</button>

    <script>
	let userCounter = localStorage.getItem('userCounter') ? parseInt(localStorage.getItem('userCounter')) : 1;
	
        // Массив для хранения сообщений чатов
        let chats = {};
    let currentUserId = null;

    // Функция для открытия чата с указанным пользователем
    function openChat(userId = null, service) {
    // Генерируем userId для незарегистрированного пользователя
    if (!userId) {
        userId = `user_${userCounter}`;
        userCounter++;
        localStorage.setItem('userCounter', userCounter); // Сохраняем обновленный счетчик
    }
    
    currentUserId = userId;
    const chatModal = document.getElementById('chat-modal');
    chatModal.style.display = 'block';
    const chatBody = document.getElementById('chat-body');
    chatBody.innerHTML = ''; // Очистите предыдущее содержимое

    // Проверьте, существует ли чат с данным пользователем
    if (!chats[userId]) {
        chats[userId] = [];
        // Добавьте начальное сообщение пользователя
        chats[userId].push({ sender: 'user', message: 'Здравствуйте! Я заинтересовался этим товаром: ' + service });

        // Добавьте автоматический ответ администратора только один раз
        chats[userId].push({ sender: 'admin', message: 'Спасибо за ваш интерес к этому товару. Скоро с вами свяжутся' });
    }

    // Отобразите все сообщения чата
    chats[userId].forEach(msg => {
        const messageElement = document.createElement('div');
        messageElement.className = `message ${msg.sender}-message`;
        messageElement.textContent = msg.message;
        chatBody.appendChild(messageElement);
    });

    playNotificationSound();
	}

    // Функция для закрытия чата
    function closeChat() {
        const chatModal = document.getElementById('chat-modal');
        chatModal.style.display = 'none';
    }

    // Функция для отправки сообщений
    function sendMessage() {
        if (!currentUserId) {
            alert('Выберите чат для отправки сообщения.');
            return;
        }

        const chatInput = document.getElementById('chat-input');
        if (chatInput.value.trim() !== '') {
            const chatBody = document.getElementById('chat-body');

            // Сообщение пользователя
            const userMessage = chatInput.value;
            chats[currentUserId].push({ sender: 'user', message: userMessage });

            const userMessageElement = document.createElement('div');
            userMessageElement.className = 'message user-message';
            userMessageElement.textContent = userMessage;
            chatBody.appendChild(userMessageElement);

            // Очистка поля ввода
            chatInput.value = '';

            playNotificationSound();
        }
    }

    function playNotificationSound() {
        const audio = new Audio('path/to/sound.mp3'); // Добавьте тихий, мягкий звуковой файл.
        audio.play();
    }

    // Функция для смены темы сайта
    function toggleTheme() {
        document.body.classList.toggle('dark-theme');
        const themeToggleButton = document.getElementById('theme-toggle');
        if (document.body.classList.contains('dark-theme')) {
            themeToggleButton.innerHTML = '&#x2600;'; // Значок солнца
            themeToggleButton.classList.add('dark-mode');
        } else {
            themeToggleButton.innerHTML = '&#x1F311;'; // Значок луны
            themeToggleButton.classList.remove('dark-mode');
        }
    }

    // Функция для закрытия нижнего блока (footer)
    function closeFooter() {
        const footer = document.getElementById('footer-block');
        if (footer) {
            footer.style.display = 'none';
            showArrow();
        }
    }

    // Функция для отображения стрелочки после закрытия footer
    function showArrow() {
        const arrow = document.createElement('div');
        arrow.id = 'footer-arrow';
        arrow.onclick = function() {
            const footer = document.getElementById('footer-block');
            footer.style.display = 'block';
            document.body.removeChild(arrow);
        };
        document.body.appendChild(arrow);
    }

    // Добавление обработчика события для отправки сообщения при нажатии клавиши "Enter"
    document.getElementById('chat-input').addEventListener('keydown', function(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    });
	
	// Добавляем функциональность перетаскивания чата
    const chatModal = document.getElementById('chat-modal');
    const chatHeader = document.querySelector('.chat-header');
    let isDragging = false;
    let offsetX = 0;
    let offsetY = 0;

    chatHeader.addEventListener('mousedown', (event) => {
        isDragging = true;
        offsetX = event.clientX - chatModal.getBoundingClientRect().left;
        offsetY = event.clientY - chatModal.getBoundingClientRect().top;
        chatHeader.classList.add('dragging');
    });
	
	

    document.addEventListener('mousemove', (event) => {
        if (isDragging) {
            let x = event.clientX - offsetX;
            let y = event.clientY - offsetY;

            // Ограничиваем перетаскивание чата, чтобы он оставался в пределах окна браузера
            x = Math.max(0, Math.min(window.innerWidth - chatModal.clientWidth, x));
            y = Math.max(0, Math.min(window.innerHeight - chatModal.clientHeight, y));

            chatModal.style.left = x + 'px';
            chatModal.style.top = y + 'px';
            chatModal.style.bottom = 'auto'; // Убираем фиксированное значение bottom
            chatModal.style.right = 'auto'; // Убираем фиксированное значение right
        }
    });

    document.addEventListener('mouseup', () => {
        isDragging = false;
        chatHeader.classList.remove('dragging');
    });
    </script>
</body>
</html>